<!DOCTYPE html>
<html>

<head>
  <script src="https://unpkg.com/babel-standalone@6.26.0/babel.min.js"></script>
  <script src="https://unpkg.com/react@16.8.6/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@16.8.6/umd/react-dom.development.js" crossorigin></script>
  <link rel='stylesheet' href='https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css' />
</head>

<body>
  <div id='root' class='container' />
  <script type='text/babel'>
    const root = document.querySelector('#root');

    class DisplayNames extends React.Component {
      render () {
        const hash = this.props.hash.current
        const people = this.props.people
        const personObj = people[hash]

        console.log(personObj)
        console.log(hash)
        return<div>
          <ul>
            {people.map((person) => {
              const hashName = '#' + people.indexOf(person)
              return <div key={person.name} >
                <a href={hashName} >{person.name}</a>
              </div>}
            )}
          </ul>
          <ul>
            <li>name</li>
              <p>{personObj.name}</p>
              <li>height</li>
              <p>{personObj.height}</p>
            <li>mass</li>
              <p>{personObj.mass}</p>
            <li>hair_color</li>
              <p>{personObj.hair_color}</p>
              <li>skin_color</li>
              <p>{personObj.skin_color}</p>
            <li>eye_color</li>
              <p>{personObj.eye_color}</p>
            <li>birth_year</li>
              <p>{personObj.birth_year}</p>
            <li>gender</li>
              <p>{personObj.gender}</p>
            <li>homeworld</li>
              <p>{personObj.homeworld}</p>
            <li>films</li>
              <p>{personObj.films}</p>
            <li>species</li>
              <p>{personObj.species}</p>
            <li>vehicles</li>
              <p>{personObj.vehicles}</p>
            <li>starships</li>
              <p>{personObj.starships}</p>
            <li>url</li>
              <p>{personObj.url}</p>

          </ul>
        </div>
      }
    }

    class Main extends React.Component {
      constructor () {
        super()
        this.state = {
          people: [{
            name: "Luke Skywalker",
            height: "172",
            mass: "77",
            hair_color: "blond",
            skin_color: "fair",
            eye_color: "blue",
            birth_year: "19BBY",
            gender: "male",
            homeworld: "https://swapi.co/api/planets/1/",
            films: [
            "https://swapi.co/api/films/2/",
            ],
            species: [
            "https://swapi.co/api/species/1/"
            ],
            vehicles: [
            "https://swapi.co/api/vehicles/14/",
            ],
            starships: [
            "https://swapi.co/api/starships/12/",
            ],
            created: "2014-12-09T13:50:51.644000Z",
            edited: "2014-12-20T21:17:56.891000Z",
            url: "https://swapi.co/api/people/1/"}],
          hash: {
            current: 0
          }
        }
      }

      async componentDidMount () {
        try {
        const response = await fetch('https://swapi.co/api/people/?format=json');
        const swData = await response.json();
        const people = swData.results
        this.setState({ people })
        window.addEventListener('hashchange', ()=> {
          this.setState({ hash: this.hashChange() })
        })
        }
        catch (err) {
          console.log('There is an error that shows: ', err)
        }
      }

      hashChange(){
        let current = 'home';
        const hash = window.location.hash.slice(1);
        if (hash){
          current = hash;
        }
        return { current };
      }

      render() {
        return (
          <div id='container'>
            <h1>Star Wars People with React!</h1>
            <div id='peopleList'>
              <DisplayNames people={this.state.people} hash={this.state.hash}/>
            </div>
          </div>
        );
      }
    }

    ReactDOM.render(<Main />, root)
  </script>
</body>
</html>
